name: Node CI

on: push

jobs:
    # test:
    #     name: Test on node ${{ matrix.node_version }} and ${{ matrix.os }}
    #     runs-on: ${{ matrix.os }}
    #     strategy:
    #         matrix:
    #             node_version: [8, 10, 12]
    #             os: [ubuntu-latest, windows-latest, macos-latest]

    #     steps:
    #         - uses: actions/checkout@v1

    #         - name: npm install and add version
    #           run: npm install

    update:
        # needs: test
        runs-on: macos-latest
        steps:
            - uses: actions/checkout@v2
            - uses: actions/setup-node@v2
              with:
                  node-version: 15.8.0
            - name: npm install and add version
              run: npm install
            - name: write npmrc
              env:
                  TOKEN: ${{ secrets.NPM_TOKEN }}
              run: |
                  echo '$TOKEN'    
                  echo '//registry.npmjs.org/:_authToken=$TOKEN' >.npmrc

            # - run: npm version patch
            # - uses: JS-DevTools/npm-publish@v1
            #   with:
            #       token: ${{ secrets.NPM_TOKEN }}
            # - run: git config --global user.email 'yiper.fan@gmail.com'
            # - run: git config --global user.name "yiper"
            # - run: git add .
            # - run: git commit -am 'github action 提交'
            # - run: git push
            - run: npm token
            - run: npm whoami
            - run: npm view
